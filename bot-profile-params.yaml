---
name: bot-profile-params
namespace: neustar.citrix.adc.commontypes
version: "6.2"
display-name: "StyleBook contains the parameters of BOT profile"
description: "StyleBook contains the parameters of BOT profile"
schema-version: "1.0"
private: true
parameters:
  -
    name: botsignature-name
    description: "Name of the BOT signature object."
    label: BOT Signature Object Name
    type: string
    min-length: 1
    max-length: 31
  -
    name: error-url
    description: "URL to redirect in case of an error. Maximum Length: 63"
    label: Error URL
    type: string
    min-length: 1
    max-length: 63
  -
    name: comment
    label: comments
    description: "A brief description about the bot profile. MaxLength = 255"
    type: string
    min-length: 1
    max-length: 255
  -
    name: allowed-list-settings
    label: Allowed List
    description: "A customized list of IP addresses, subnets, and policy expressions that can be bypassed as allowed list"
    type: object
    parameters:
      -
        name: enable-allowed-list
        label: Enable BOT Allowed List
        description: "Enable BOT Allowed List Detection"
        type: boolean
        default: false
      -
        name: bot-allowed-list
        label: BOT Allowed List
        description: "List of Allowed List Entities"
        type: object[]
        parameters:
          -
            name: enable
            label: Enable
            description: "Enable the Allowed List Entity"
            type: boolean
            default: true
          -
            name: type
            label: Type
            description: "BOT Allowed List Type"
            type: string
            allowed-values:
              - "IPv4"
              - "SUBNET"
              - "EXPRESSION"
            default: "IPv4"
            required: true
          -
            name: value
            label: Value
            description: "BOT Allowed List Value"
            type: string
            required: true
          -
            name: log
            label: Enable Logging
            description: "Enable Logging for the Allowed List Entry"
            type: boolean
            default: true
          -
            name: log-message
            description: "Message to be logged. Max Length: 255"
            label: LogMessage
            type: string
            min-length: 1
            max-length: 255
          -
            name: comment
            description: "Any comments about the binding. Max Length: 255."
            label: Comment
            type: string
            min-length: 1
            max-length: 255
            gui:
                summary_display: false
  -
    name: blocked-list-settings
    label: Blocked List
    description: "A customized list of IP addresses, subnets, and policy expressions that has to be blocked from accessing your web applications"
    type: object
    parameters:
      -
        name: enable-blocked-list
        label: Enable BOT Blocked List
        description: "Enable BOT Blocked List Detection"
        type: boolean
        default: false
      -
        name: bot-blocked-list
        label: BOT Blocked List
        description: "List of Blocked List Entities"
        type: object[]
        parameters:
          -
            name: enable
            label: Enable
            description: "Enable the Blocked List Entity"
            type: boolean
            default: true
          -
            name: type
            label: Type
            description: "BOT Blocked List Type"
            type: string
            allowed-values:
              - "IPv4"
              - "SUBNET"
              - "EXPRESSION"
            default: "IPv4"
            required: true
          -
            name: value
            label: Value
            description: "BOT Blocked List Value"
            type: string
            required: true
          -
            name: actions
            label: Actions
            description: |
              One or more actions to be taken if bot is detected based on this Blocked List Entity.
              *Only LOG action can be combined with DROP or RESET action
            type: string[]
            allowed-values:
              - "LOG"
              - "DROP"
              - "RESET"
              - "REDIRECT"
              - "NONE"
            default:
              - "DROP"
            required: true
          -
            name: log-message
            description: "Message to be logged. Max Length: 255"
            label: LogMessage
            type: string
            min-length: 1
            max-length: 255
          -
            name: comment
            description: "Any comments about the binding. Max Length: 255."
            label: Comment
            type: string
            min-length: 1
            max-length: 255
            gui:
                summary_display: false
  -
    name: ip-reputation-settings
    label: IP Reputation
    description: "Examines if the incoming bot traffic is from a malicious IP address"
    type: object
    parameters:
      -
        name: enable-ip-reputation
        label: Enable IP Reputation
        description: "Enable BOT IP Reputation Detection"
        type: boolean
        default: false
      -
        name: bot-ip-reputation-configs
        label: BOT IP Reputation Configurations
        description: "List of IP Reputation Configurations"
        type: object[]
        parameters:
          -
            name: enable
            label: Enable
            description: "Enable the BOT IP Reputation Configuration"
            type: boolean
            default: true
          -
            name: category
            label: Category
            description: |
              IP Repuation category. Following IP Reuputation categories are allowed:
              *IP_BASED - This category checks whether client IP is malicious or not.
              *BOTNETS - This category includes Botnet C&C channels, and infected zombie machines controlled by Bot master.
              *SPAM_SOURCES - This category includes tunneling spam messages through a proxy, anomalous SMTP activities, and forum spam activities.
              *SCANNERS - This category includes all reconnaissance such as probes, host scan, domain scan, and password brute force attack.
              *DOS - This category includes DOS, DDOS, anomalous sync flood, and anomalous traffic detection.
              *REPUTATION - This category denies access from IP addresses currently known to be infected with malware. This category also includes IPs with average low Webroot Reputation Index score. Enabling this category will prevent access from sources identified to contact malware distribution points.
              *PHISHING - This category includes IP addresses hosting phishing sites and other kinds of fraud activities such as ad click fraud or gaming fraud.
              *PROXY - This category includes IP addresses providing proxy services.
              *NETWORK - IPs providing proxy and anonymization services including The Onion Router aka TOR or darknet.
              *MOBILE_THREATS - This category checks client IP with the list of IPs harmful for mobile devices.
            type: string
            allowed-values:
              - "SPAM_SOURCES"
              - "IP"
              - "BOTNETS"
              - "SCANNERS"
              - "DOS"
              - "REPUTATION"
              - "PHISHING"
              - "PROXY"
              - "NETWORK"
              - "MOBILE_THREATS"
            default: "IP"
            required: true
          -
            name: actions
            label: Actions
            description: |
              One or more actions to be taken if bot is detected based on this IP Reputation binding.
              *Only LOG action can be combinded with DROP, RESET, REDIRECT or MITIGATION action.
            type: string[]
            allowed-values:
              - "NONE"
              - "LOG"
              - "DROP"
              - "REDIRECT"
              - "RESET"
              - "MITIGATION"
            default:
              - "NONE"
            required: true
          -
            name: log-message
            description: "Message to be logged. Max Length: 255"
            label: LogMessage
            type: string
            min-length: 1
            max-length: 255
          -
            name: comment
            description: "Any comments about the binding. Max Length: 255."
            label: Comment
            type: string
            min-length: 1
            max-length: 255
            gui:
                summary_display: false
  -
    name: rate-limit-settings
    label: Rate Limit
    description: "Examines if a client request is received within a predefined time from a client IP address, a session, or a configured resource (for example, from a URL)."
    type: object
    parameters:
      -
        name: enable-rate-limit
        label: Enable BOT Rate Limit
        description: "Enable BOT Rate Limit Detection"
        type: boolean
        default: false
      -
        name: bot-rate-limit-configs
        label: BOT Rate Limit Configurations
        description: "List of Rate Limit Configurations"
        type: object[]
        parameters:
          -
            name: enable
            label: Enable
            description: "Enable the Rate Limit Configuration"
            type: boolean
            default: true
          -
            name: type
            label: Type
            description: |
              Following Rate-Limiting types are allowed:
              *SOURCE_IP - Rate-limiting based on the client IP
              *SESSION - Rate-limiting based on the configured cookie name
              *URL - Rate-limiting based on the configured URL
            type: string
            allowed-values:
              - "SESSION"
              - "SOURCE_IP"
              - "URL"
            default: "SESSION"
            required: true
          -
            name: url
            label: Rate Limit URL
            description: "URL for the resoruce based rate-limiting. Max Length: 127"
            type: string
            min-length: 1
            max-length: 127
          -
            name: cookie-name
            label: Cookie Name
            description: "Cookie name to identify the session for session rate-limiting. Max Length: 255"
            type: string
            min-length: 1
            max-length: 255
          -
            name: rate
            label: Rate
            description: "Maximum number of requests that are allowed in the given period time. Min Value: 1000 Max Value: 10000000"
            type: number
            #min-value: 1
            #max-value: 4294967295
            #default: 1
            required: true
          -
            name: timeslice
            label: Time Slice
            description: "Time interval, in milliseconds, during which requests are tracked to check if they cross the given rate. Should be a multiple of 10. Min Value: 1000 Max Value: 10000000"
            type: number
            #min-value: 10
            #max-value: 4294967290
            #default: 1000
            required: true
          -
            name: actions
            label: Actions
            description: "One or more actions to be taken when the current rate becomes more than the configured rate.
    Only LOG action can be combined with DROP, RESET, REDIRECT action."
            type: string[]
            allowed-values:
              - "NONE"
              - "LOG"
              - "DROP"
              - "REDIRECT"
              - "RESET"
            default:
              - "NONE"
            required: true
          -
            name: log-message
            description: "Message to be logged. Max Length: 255"
            label: LogMessage
            type: string
            min-length: 1
            max-length: 255
          -
            name: comment
            description: "Any comments about the binding. Max Length: 255."
            label: Comment
            type: string
            min-length: 1
            max-length: 255
            gui:
                summary_display: false
  -
    name: devicefingerprint-settings
    label: Device Fingerprint
    description: "Detects if the incoming bot traffic has device fingerprint ID in the incoming request header and browser attributes"
    type: object
    parameters:
      -
        name: enable-devicefingerprint
        label: Enable DeviceFingerprint
        description: "Enable BOT DeviceFingerprint Detection"
        type: boolean
        default: false
      -
        name: bot-devicefingerprint-actions
        label: DeviceFingerprint Actions
        description: |
          One or more action to be taken for device-fingerprint based bot detection.
          *Only LOG action can be combined with DROP, RESET, REDIRECT, MITIGATION action.
        type: string[]
        allowed-values:
          - "NONE"
          - "LOG"
          - "DROP"
          - "REDIRECT"
          - "RESET"
          - "MITIGATION"
        default:
          - "NONE"
        required: true
  -
    name: tps-settings
    label: TPS
    description: "Detects incoming traffic as bots if the maximum number of requests and percentage increase in requests exceeds the configured time interval"
    type: object
    parameters:
      -
        name: enable-bot-tps
        label: Enable BOT TPS
        description: "Enable BOT TPS"
        type: boolean
        default: false
      -
        name: bot-tps-configs
        label: BOT TPS Configurations
        description: "BOT TPS Configurations"
        type: object[]
        parameters:
          -
            name: type
            label: BOT TPS Type
            description: |
              BOT TPS types allowed:
              *SOURCE_IP - Limit Transactions based on the client IP
              *SESSION - Limit Transactions based on the configured cookie name
              *URL - Limit Transactions based on the configured URL
              *HOST - TPS based on client requests forwarded to a specific back-end server IP address
            type: string
            allowed-values:
              - "SOURCE_IP"
              - "GEOLOCATION"
              - "REQUEST_URL"
              - "HOST"
            default: "SOURCE_IP"
            required: true
          -
            name: threshold
            label: Number of requests
            description: "Maximum number of requests that are allowed in 1 second time interval. Min Value: 1 Max Value: 10000000"
            type: number
            min-value: 1
            max-value: 10000000
          -
            name: percentage
            label: Percentage Increase in requests
            description: "Maximum percentage increase in the requests in 30 minutes interval. Min Value: 10 Max Value: 10000000"
            type: number
            min-value: 10
            max-value: 10000000
          -
            name: actions
            label: Actions
            description: "One to more actions to be taken if bot is detected based on this TPS rule.
    Only LOG action can be combined with DROP, RESET, REDIRECT, or MITIGIATION action."
            type: string[]
            allowed-values:
              - "NONE"
              - "LOG"
              - "DROP"
              - "REDIRECT"
              - "RESET"
              - "MITIGATION"
            default:
              - "NONE"
            required: true
          -
            name: log-message
            description: "Message to be logged. Max Length: 255"
            label: LogMessage
            type: string
            min-length: 1
            max-length: 255
          -
            name: comment
            description: "Any comments about the binding. Max Length: 255."
            label: Comment
            type: string
            min-length: 1
            max-length: 255
            gui:
                summary_display: false
  -
    name: trap-url-settings
    label: BOT Trap
    description: "Detects if the incoming bot traffic is from a human user or an automated bot and based on detection, the rule blocks any subsequent request from an automated bot"
    type: object
    parameters:
      -
        name: enable-bot-trap
        label: Enable BOT Trap
        description: "Enable BOT Trap Detection"
        type: boolean
        default: false
      -
        name: bot-trap-actions
        label: BOT Trap Actions
        description: |
          One or more action to be taken based on bot trapu detection.
          *Only LOG action can be combined with DROP, RESET, REDIRECT, MITIGATION action.
        type: string[]
        allowed-values:
          - "NONE"
          - "LOG"
          - "DROP"
          - "REDIRECT"
          - "RESET"
        default:
          - "NONE"
        required: true
      -
        name: trap-url
        label: Trap URL
        description: "URL to capture access by bots. Maximum Length: 127 Trap Url should start with '/'"
        type: string
        min-length: 1
        max-length: 127
      -
        name: trap-insertion-url
        label: Trap Insertion URLs
        description: "Bot Trap Insertion URL list"
        type: object[]
        parameters:
          -
            name: insertion-url
            label: Url
            description: "Bot Trap Insertion URL"
            type: string
            min-length: 1
            max-length: 127
            required: true
          -
            name: comment
            description: "Any comments about the binding. Max Length: 255"
            label: Comment
            type: string
            min-length: 1
            max-length: 255
          -
            name: enable
            label: Enable
            description: "Enable/Disable the BOT Trap Insertion URL"
            type: boolean
            default: false
  -
    name: captcha-mitigation-settings
    label: CAPTCHA
    description: "Detects if the incoming traffic is from a human user or an automated bot. CAPTCHA blocks automated bot traffic that cause security violations to web applications"
    type: object
    parameters:
      -
        name: captcha-mitigation-configs
        label: Captcha Mitigation Configurations
        description: "Captcha Mitigation Configurations"
        type: object[]
        parameters:
          -
            name: enable
            label: Enable
            description: "Enable/Disable the BOT Captcha Configuration"
            type: boolean
            default: true
          -
            name: captcha-url
            label: Captcha URL
            description: "URL for which the Captcha action, if configured, need to be applied. Max Length: 127"
            type: string
            min-length: 1
            max-length: 127
            required: true
          -
            name: wait-time
            label: Wait Time
            description: "Wait time in seconds for which ADC needs to wait for the Captcha response. Min Value: 10 Max Value: 60"
            type: number
            default: 15
            min-value: 10
            max-value: 60
          -
            name: grace-period
            label: Grace Period
            description: "Time duration in seconds for which no new captcha challenge is sent after current captcha challenge has been answered successfully. Min Value: 60 Max Value: 900"
            type: number
            default: 900
            min-value: 60
            max-value: 900
          -
            name: mute-period
            label: Mute Period
            description: |
              Time duration in seconds for which client which failed captcha need to wait until allowed to try again.
              The requests from this client are silently dropped during the mute period Min Value: 60 Max Value: 900
            type: number
            default: 300
            min-value: 60
            max-value: 900
          -
            name: request-size-limit
            label: Request Size Limit
            description: |
              Length of body request up to which captcha challenge will be provided to client.
              Above this length threshold the request will be dropped. Min Value: 10 Max Value: 30000
            type: number
            default: 8000
            min-value: 10
            max-value: 30000
          -
            name: retry-attempts
            label: Retry Attempts
            description: "Number of times client can retry solving the captcha. Min Value: 1 Max Value: 10"
            type: number
            default: 3
            min-value: 1
            max-value: 10
          -
            name: actions
            label: Actions
            description: |
              One or more actions to be taken when client fails captcha challenge.
              Only LOG action can be configured with DROP, REDIRECT or RESET action
            type: string[]
            allowed-values:
              - "NONE"
              - "LOG"
              - "DROP"
              - "REDIRECT"
              - "RESET"
            default:
              - "NONE"
            required: true
          -
            name: log-message
            description: "Message to be logged. Max Length: 255"
            label: LogMessage
            type: string
            min-length: 1
            max-length: 255
          -
            name: comment
            description: "Any comments about the binding. Max Length: 255"
            label: Comment
            type: string
            min-length: 1
            max-length: 255
            gui:
                summary_display: false
